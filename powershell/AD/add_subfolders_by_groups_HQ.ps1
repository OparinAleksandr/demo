#указываем путь к корневой папке
$share = "C:\HQ"
#берем csv файл со списком имен групп и названием папок
Import-Csv "C:\pss\list_of_folders_by_groups_HQ.csv" | ForEach-Object {    #получаем имя группы из файла    $group = [Security.Principal.NTAccount]$_.groupname    #создаём правила доступа к папкам    #запрет на удаление    $rdele = New-Object Security.AccessControl.FileSystemAccessRule($group,"Delete","Deny")    #разрешение на изменения    $rgmod = New-Object Security.AccessControl.FileSystemAccessRule($group,"Modify","ContainerInherit,ObjectInherit","None","Allow")    $remod = New-Object Security.AccessControl.FileSystemAccessRule($everyone,"Modify","ContainerInherit,ObjectInherit","None","Allow")    $sub2 = "$share\$($_.folder)\$($_.subfolder2)"    md $sub2    $acl = Get-Acl $sub2    #отключаем наследование прав корневой папки с сохранением наследуемых прав	$acl.SetAccessRuleProtection($true,$false)    #устанавливаем свои права    $acl.AddAccessRule($rdele) | Out-Null    $acl.AddAccessRule($rgmod) | Out-Null    $acl.AddAccessRule($remod) | Out-Null	$acl | Set-Acl $sub2}